<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Knowledge – quarto-input5c96f5c7</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Knowledge</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../notes.html">Stanford Notes</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../machine-learning.html">Machine Learning</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../concepts.html">Concepts</a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#week-2-lecture-1---transfer-learning-start-of-meta-learning" id="toc-week-2-lecture-1---transfer-learning-start-of-meta-learning" class="nav-link active" data-scroll-target="#week-2-lecture-1---transfer-learning-start-of-meta-learning">Week 2, Lecture 1 - Transfer Learning + Start of Meta-Learning</a>
  <ul class="collapse">
  <li><a href="#transfer-learning" id="toc-transfer-learning" class="nav-link" data-scroll-target="#transfer-learning">Transfer learning</a>
  <ul class="collapse">
  <li><a href="#how-is-it-different-from-mult-task" id="toc-how-is-it-different-from-mult-task" class="nav-link" data-scroll-target="#how-is-it-different-from-mult-task">How is it different from mult-task?</a></li>
  <li><a href="#transfer-learning-via-fine-tuning" id="toc-transfer-learning-via-fine-tuning" class="nav-link" data-scroll-target="#transfer-learning-via-fine-tuning">Transfer learning via fine-tuning</a></li>
  <li><a href="#where-might-the-common-wisdom-break" id="toc-where-might-the-common-wisdom-break" class="nav-link" data-scroll-target="#where-might-the-common-wisdom-break">Where might the common wisdom break?</a></li>
  </ul></li>
  <li><a href="#meta-learning" id="toc-meta-learning" class="nav-link" data-scroll-target="#meta-learning">Meta-learning</a>
  <ul class="collapse">
  <li><a href="#probabilistic-ml" id="toc-probabilistic-ml" class="nav-link" data-scroll-target="#probabilistic-ml">Probabilistic ML</a></li>
  <li><a href="#mechanistic-view" id="toc-mechanistic-view" class="nav-link" data-scroll-target="#mechanistic-view">Mechanistic view</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<section id="week-2-lecture-1---transfer-learning-start-of-meta-learning" class="level1">
<h1>Week 2, Lecture 1 - Transfer Learning + Start of Meta-Learning</h1>
<section id="transfer-learning" class="level2">
<h2 class="anchored" data-anchor-id="transfer-learning">Transfer learning</h2>
<blockquote class="blockquote">
<p>🍎 <strong>Transfer learning</strong>: Solve target task 𝒯 after solving source task(s) b 𝒯a by transferring knowledge learned from 𝒯a.</p>
</blockquote>
<section id="how-is-it-different-from-mult-task" class="level3">
<h3 class="anchored" data-anchor-id="how-is-it-different-from-mult-task">How is it different from mult-task?</h3>
<ul>
<li>MT: solve multiple tasks (<span class="math inline">\(\mathscr{T}_1, \cdots, \mathscr{T}_T\)</span>) at once: <span class="math inline">\(\min _\theta \sum_{i=1}^T \mathscr{L}_i\left(\theta, \mathscr{D}_i\right)\)</span>.</li>
<li>TL: Solve target task 𝒯 after solving source task(s) b 𝒯a by transferring knowledge learned from 𝒯a.
<ul>
<li>Assumption: cannot access data 𝒟 during transfer. (<strong>data is separate</strong>).</li>
</ul></li>
<li>Good to use TL over MT when
<ul>
<li>More data in source task than target task</li>
<li>Don’t care about solving tasks at the same time</li>
<li>Pre-trained weights for source task are available (e.g., pre-training on imagenet)</li>
</ul></li>
<li>In TL, we don’t need to solve tasks at the same time… just adaption.</li>
<li>In this sense: transfer learning is a valid solution to multi-task learning (but not vice versa).
<ul>
<li>We can do multiple tasks in TL but MT doesn’t <em>transfer</em> represenations over.</li>
</ul></li>
</ul>
</section>
<section id="transfer-learning-via-fine-tuning" class="level3">
<h3 class="anchored" data-anchor-id="transfer-learning-via-fine-tuning">Transfer learning via fine-tuning</h3>
<p>Most common way to do TL: pre-training the weights for init purposes. Then use traditional gradient steps to update the parameters.</p>
<p align="center">
<img alt="picture 1" src="https://cdn.jsdelivr.net/gh/minimatest/vscode-images/images/f256d0d3566f83dd218f87ef8c32c048dc81e89d815fe7d5a5f503dfd2440075.png" width="300">
</p>
<p>Idea is that you can pre-learn just <em>general</em> image features for example and then use this features when training on a new task. This applies for example, even when you pre-train using ImageNet for a medical image task.</p>
<ul>
<li>Question: criterion for when TL will work/helpful?
<ul>
<li>Difficult, open question, some general common wisdom though (i.e., two medical tasks that are related… not hard rule though).</li>
</ul></li>
<li>Where to get pre-trained params?
<ul>
<li>ImageNet</li>
<li>Large language corpora</li>
</ul></li>
<li>Mathematical perspective: we have non-convex function we need to optimize. By pre-training, we can start in a better “basin” in the loss landscape.</li>
</ul>
<section id="common-design-choices-common-wisdom" class="level4">
<h4 class="anchored" data-anchor-id="common-design-choices-common-wisdom">Common design choices (common wisdom)</h4>
<p>Above, we specified the general framework for pre-training/fine-tuning. But there exists many variants to this framework. The general idea is that we want to preserve a good balance of the old data while learning from the new data. In this sense, we can choose, for example, how many layers to freeze when training. Here are some common params:</p>
<ul>
<li>Motivation: typically you need to adjust the last layer for your task. This means we need to randomly init the last layer. However, during backprop, these random weights will “hit” the earlier layer weights and embed unwanted randomness into it. And for that reason, it might make sense to freeze the earlier layer weights so that we don’t override the valuable general features that we learned earlier.</li>
</ul>
<p align="center">
<img alt="picture 2" src="https://cdn.jsdelivr.net/gh/minimatest/vscode-images/images/7de59870c07d7bb724dac3f57c9077dc486cd6ad0ad957f5bcf61e505719b34e.png" width="300">
</p>
<p>Question: what is the difference between the above paradigm and self-supervised pre-training (e.g., using things like DINO and things like image puzzle occlusion)?</p>
<p>Question: do you need labels to pre-train for a target task that is supervised?</p>
</section>
</section>
<section id="where-might-the-common-wisdom-break" class="level3">
<h3 class="anchored" data-anchor-id="where-might-the-common-wisdom-break">Where might the common wisdom break?</h3>
<p>(Note: by common wisdom, we mean the things generally people do when TL’ing: e.g., freeze all layers but last, need diverse source dataset, etc.)</p>
<p>Here are some recent results:</p>
<ul>
<li>From the paper: “Unsupervised pre-training objectives may not require diverse data for pre-training.”
<ul>
<li>Result was that you don’t actually need a diverse data set for pre-training (breaks common wisdom).</li>
</ul></li>
<li>Yoonho’s (TA) recent experiment
<ul>
<li>We know that fine-tuning works well for only last layer. But why? last layer is really just like any other layer.</li>
<li>Maybe for low-level distribution shifts, it might actually be better to only train a first layer and freeze the rest.</li>
<li>Result: Fine-tuning the first or middle layers can work better than the last layers.</li>
<li>Paper was released just last week! (Lee<em>, Chen</em>, Tajwar, Kumar, Yao, Liang, Finn. Surgical Fine-Tuning Improves Adaptation to Distribution Shifts. Openreview 09/28/22.).</li>
</ul></li>
</ul>
<p>Ok… wow lots of design choices then. Despite this, Chelsea recommends:</p>
<ul>
<li>Train last layer then fine-tune entire network</li>
</ul>
<p align="center">
<img alt="picture 3" src="https://cdn.jsdelivr.net/gh/minimatest/vscode-images/images/c0edd64e1773724db7c60f580f6e260f806ed00ca7d0c938cc67b147a6d88eb4.png" width="300">
</p>
<ul>
<li>And the idea is that we don’t mess up the earlier learned features by init the last layer to be within scope of the previous ones first before actually fine-tuning.</li>
</ul>
<blockquote class="blockquote">
<p>Major problem: Fine-tuning doesn’t work well with very small target task datasets. This is where meta-learning can help.</p>
</blockquote>
</section>
</section>
<section id="meta-learning" class="level2">
<h2 class="anchored" data-anchor-id="meta-learning">Meta-learning</h2>
<p>We will cover: - Problem formulation - General recipe of meta-learning algorithms</p>
<p>Two views: mechanistic and probabilisitc.</p>
<section id="probabilistic-ml" class="level3">
<h3 class="anchored" data-anchor-id="probabilistic-ml">Probabilistic ML</h3>
<ul>
<li>Bayesian networks review: many random variables as nodes in a direct graph. <span class="math inline">\(P(y | x)\)</span> (distribution) means <span class="math inline">\(y\)</span> is dependent on <span class="math inline">\(x\)</span> (not vise versa).</li>
<li>Let’s now draw the graphical model for classic single-task learning.</li>
</ul>
<p align="center">
<img alt="picture 4" src="https://cdn.jsdelivr.net/gh/minimatest/vscode-images/images/435375bb51bb210cb487820da262abfcb2226faf6cf25284489e979754d329f4.png" width="200">
</p>
<ul>
<li>Now multi-task learning:</li>
</ul>
</section>
<section id="mechanistic-view" class="level3">
<h3 class="anchored" data-anchor-id="mechanistic-view">Mechanistic view</h3>
<p>…</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>